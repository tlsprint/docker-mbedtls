# This file is automatically generated with Dockerfile.j2 as a template. Do not
# edit by hand, since your changes will be lost!
FROM buildpack-deps AS builder

# Create a shallow clone of the implementation repository in the work directory,
# containing only the code of the specified version/tag.
WORKDIR /mbedtls
RUN git clone --branch polarssl-0.12.0 --depth 1 https://github.com/ARMmbed/mbedtls.git .

# The test fail to build on this version, but the program and libraries build
# just fine. To work around this issue, remove the lines from the Makefile that
# specify the tests.
RUN sed -i "/cd tests/d" Makefile

# Build
RUN make

# Install to a temporary directory
RUN make install DESTDIR=/tmp/package-dir