---
kind: pipeline
name: 1.0.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.0.0
      dockerfile: dockerfiles/1.0.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.0.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.0.0
      dockerfile: dockerfiles/1.0.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.1.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.0
      dockerfile: dockerfiles/1.1.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.1.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.0
      dockerfile: dockerfiles/1.1.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.1.1

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.1
      dockerfile: dockerfiles/1.1.1/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.1.1
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.1
      dockerfile: dockerfiles/1.1.1/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.1.2

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.2
      dockerfile: dockerfiles/1.1.2/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.1.2
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.2
      dockerfile: dockerfiles/1.1.2/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.1.3

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.3
      dockerfile: dockerfiles/1.1.3/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.1.3
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.3
      dockerfile: dockerfiles/1.1.3/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.1.4

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.4
      dockerfile: dockerfiles/1.1.4/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.1.4
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.4
      dockerfile: dockerfiles/1.1.4/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.1.5

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.5
      dockerfile: dockerfiles/1.1.5/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.1.5
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.5
      dockerfile: dockerfiles/1.1.5/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.1.6

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.6
      dockerfile: dockerfiles/1.1.6/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.1.6
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.6
      dockerfile: dockerfiles/1.1.6/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.1.7

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.7
      dockerfile: dockerfiles/1.1.7/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.1.7
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.7
      dockerfile: dockerfiles/1.1.7/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.1.8

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.8
      dockerfile: dockerfiles/1.1.8/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.1.8
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.1.8
      dockerfile: dockerfiles/1.1.8/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.0
      dockerfile: dockerfiles/1.2.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.0
      dockerfile: dockerfiles/1.2.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.1

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.1
      dockerfile: dockerfiles/1.2.1/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.1
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.1
      dockerfile: dockerfiles/1.2.1/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.2

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.2
      dockerfile: dockerfiles/1.2.2/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.2
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.2
      dockerfile: dockerfiles/1.2.2/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.3

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.3
      dockerfile: dockerfiles/1.2.3/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.3
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.3
      dockerfile: dockerfiles/1.2.3/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.4

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.4
      dockerfile: dockerfiles/1.2.4/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.4
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.4
      dockerfile: dockerfiles/1.2.4/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.5

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.5
      dockerfile: dockerfiles/1.2.5/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.5
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.5
      dockerfile: dockerfiles/1.2.5/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.6

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.6
      dockerfile: dockerfiles/1.2.6/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.6
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.6
      dockerfile: dockerfiles/1.2.6/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.7

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.7
      dockerfile: dockerfiles/1.2.7/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.7
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.7
      dockerfile: dockerfiles/1.2.7/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.8

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.8
      dockerfile: dockerfiles/1.2.8/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.8
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.8
      dockerfile: dockerfiles/1.2.8/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.9

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.9
      dockerfile: dockerfiles/1.2.9/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.9
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.9
      dockerfile: dockerfiles/1.2.9/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.10

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.10
      dockerfile: dockerfiles/1.2.10/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.10
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.10
      dockerfile: dockerfiles/1.2.10/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.11

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.11
      dockerfile: dockerfiles/1.2.11/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.11
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.11
      dockerfile: dockerfiles/1.2.11/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.12

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.12
      dockerfile: dockerfiles/1.2.12/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.12
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.12
      dockerfile: dockerfiles/1.2.12/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.13

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.13
      dockerfile: dockerfiles/1.2.13/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.13
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.13
      dockerfile: dockerfiles/1.2.13/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.14

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.14
      dockerfile: dockerfiles/1.2.14/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.14
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.14
      dockerfile: dockerfiles/1.2.14/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.15

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.15
      dockerfile: dockerfiles/1.2.15/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.15
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.15
      dockerfile: dockerfiles/1.2.15/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.16

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.16
      dockerfile: dockerfiles/1.2.16/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.16
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.16
      dockerfile: dockerfiles/1.2.16/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.17

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.17
      dockerfile: dockerfiles/1.2.17/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.17
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.17
      dockerfile: dockerfiles/1.2.17/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.18

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.18
      dockerfile: dockerfiles/1.2.18/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.18
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.18
      dockerfile: dockerfiles/1.2.18/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.2.19

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.19
      dockerfile: dockerfiles/1.2.19/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.2.19
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.2.19
      dockerfile: dockerfiles/1.2.19/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.0
      dockerfile: dockerfiles/1.3.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.0
      dockerfile: dockerfiles/1.3.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.1

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.1
      dockerfile: dockerfiles/1.3.1/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.1
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.1
      dockerfile: dockerfiles/1.3.1/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.2

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.2
      dockerfile: dockerfiles/1.3.2/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.2
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.2
      dockerfile: dockerfiles/1.3.2/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.3

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.3
      dockerfile: dockerfiles/1.3.3/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.3
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.3
      dockerfile: dockerfiles/1.3.3/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.4

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.4
      dockerfile: dockerfiles/1.3.4/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.4
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.4
      dockerfile: dockerfiles/1.3.4/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.5

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.5
      dockerfile: dockerfiles/1.3.5/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.5
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.5
      dockerfile: dockerfiles/1.3.5/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.6

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.6
      dockerfile: dockerfiles/1.3.6/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.6
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.6
      dockerfile: dockerfiles/1.3.6/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.7

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.7
      dockerfile: dockerfiles/1.3.7/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.7
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.7
      dockerfile: dockerfiles/1.3.7/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.8

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.8
      dockerfile: dockerfiles/1.3.8/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.8
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.8
      dockerfile: dockerfiles/1.3.8/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.9

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.9
      dockerfile: dockerfiles/1.3.9/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.9
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.9
      dockerfile: dockerfiles/1.3.9/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.10

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.10
      dockerfile: dockerfiles/1.3.10/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.10
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.10
      dockerfile: dockerfiles/1.3.10/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.11

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.11
      dockerfile: dockerfiles/1.3.11/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.11
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.11
      dockerfile: dockerfiles/1.3.11/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.12

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.12
      dockerfile: dockerfiles/1.3.12/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.12
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.12
      dockerfile: dockerfiles/1.3.12/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.13

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.13
      dockerfile: dockerfiles/1.3.13/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.13
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.13
      dockerfile: dockerfiles/1.3.13/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.14

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.14
      dockerfile: dockerfiles/1.3.14/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.14
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.14
      dockerfile: dockerfiles/1.3.14/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.15

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.15
      dockerfile: dockerfiles/1.3.15/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.15
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.15
      dockerfile: dockerfiles/1.3.15/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.16

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.16
      dockerfile: dockerfiles/1.3.16/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.16
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.16
      dockerfile: dockerfiles/1.3.16/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.17

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.17
      dockerfile: dockerfiles/1.3.17/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.17
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.17
      dockerfile: dockerfiles/1.3.17/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.18

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.18
      dockerfile: dockerfiles/1.3.18/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.18
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.18
      dockerfile: dockerfiles/1.3.18/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.19

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.19
      dockerfile: dockerfiles/1.3.19/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.19
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.19
      dockerfile: dockerfiles/1.3.19/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.20

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.20
      dockerfile: dockerfiles/1.3.20/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.20
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.20
      dockerfile: dockerfiles/1.3.20/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.21

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.21
      dockerfile: dockerfiles/1.3.21/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.21
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.21
      dockerfile: dockerfiles/1.3.21/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 1.3.22

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.22
      dockerfile: dockerfiles/1.3.22/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:1.3.22
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 1.3.22
      dockerfile: dockerfiles/1.3.22/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.0.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.0.0
      dockerfile: dockerfiles/2.0.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.0.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.0.0
      dockerfile: dockerfiles/2.0.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.0
      dockerfile: dockerfiles/2.1.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.0
      dockerfile: dockerfiles/2.1.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.1

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.1
      dockerfile: dockerfiles/2.1.1/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.1
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.1
      dockerfile: dockerfiles/2.1.1/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.2

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.2
      dockerfile: dockerfiles/2.1.2/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.2
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.2
      dockerfile: dockerfiles/2.1.2/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.3

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.3
      dockerfile: dockerfiles/2.1.3/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.3
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.3
      dockerfile: dockerfiles/2.1.3/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.4

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.4
      dockerfile: dockerfiles/2.1.4/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.4
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.4
      dockerfile: dockerfiles/2.1.4/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.5

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.5
      dockerfile: dockerfiles/2.1.5/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.5
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.5
      dockerfile: dockerfiles/2.1.5/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.6

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.6
      dockerfile: dockerfiles/2.1.6/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.6
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.6
      dockerfile: dockerfiles/2.1.6/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.7

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.7
      dockerfile: dockerfiles/2.1.7/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.7
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.7
      dockerfile: dockerfiles/2.1.7/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.8

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.8
      dockerfile: dockerfiles/2.1.8/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.8
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.8
      dockerfile: dockerfiles/2.1.8/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.9

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.9
      dockerfile: dockerfiles/2.1.9/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.9
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.9
      dockerfile: dockerfiles/2.1.9/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.10

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.10
      dockerfile: dockerfiles/2.1.10/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.10
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.10
      dockerfile: dockerfiles/2.1.10/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.11

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.11
      dockerfile: dockerfiles/2.1.11/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.11
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.11
      dockerfile: dockerfiles/2.1.11/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.12

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.12
      dockerfile: dockerfiles/2.1.12/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.12
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.12
      dockerfile: dockerfiles/2.1.12/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.13

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.13
      dockerfile: dockerfiles/2.1.13/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.13
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.13
      dockerfile: dockerfiles/2.1.13/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.14

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.14
      dockerfile: dockerfiles/2.1.14/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.14
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.14
      dockerfile: dockerfiles/2.1.14/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.15

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.15
      dockerfile: dockerfiles/2.1.15/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.15
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.15
      dockerfile: dockerfiles/2.1.15/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.16

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.16
      dockerfile: dockerfiles/2.1.16/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.16
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.16
      dockerfile: dockerfiles/2.1.16/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.17

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.17
      dockerfile: dockerfiles/2.1.17/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.17
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.17
      dockerfile: dockerfiles/2.1.17/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.1.18

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.18
      dockerfile: dockerfiles/2.1.18/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.1.18
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.1.18
      dockerfile: dockerfiles/2.1.18/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.2.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.2.0
      dockerfile: dockerfiles/2.2.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.2.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.2.0
      dockerfile: dockerfiles/2.2.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.2.1

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.2.1
      dockerfile: dockerfiles/2.2.1/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.2.1
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.2.1
      dockerfile: dockerfiles/2.2.1/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.3.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.3.0
      dockerfile: dockerfiles/2.3.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.3.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.3.0
      dockerfile: dockerfiles/2.3.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.4.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.4.0
      dockerfile: dockerfiles/2.4.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.4.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.4.0
      dockerfile: dockerfiles/2.4.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.4.1

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.4.1
      dockerfile: dockerfiles/2.4.1/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.4.1
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.4.1
      dockerfile: dockerfiles/2.4.1/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.4.2

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.4.2
      dockerfile: dockerfiles/2.4.2/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.4.2
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.4.2
      dockerfile: dockerfiles/2.4.2/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.5.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.5.0
      dockerfile: dockerfiles/2.5.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.5.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.5.0
      dockerfile: dockerfiles/2.5.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.5.1

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.5.1
      dockerfile: dockerfiles/2.5.1/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.5.1
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.5.1
      dockerfile: dockerfiles/2.5.1/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.6.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.6.0
      dockerfile: dockerfiles/2.6.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.6.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.6.0
      dockerfile: dockerfiles/2.6.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.6.1

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.6.1
      dockerfile: dockerfiles/2.6.1/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.6.1
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.6.1
      dockerfile: dockerfiles/2.6.1/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.7.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.0
      dockerfile: dockerfiles/2.7.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.7.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.0
      dockerfile: dockerfiles/2.7.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.7.1

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.1
      dockerfile: dockerfiles/2.7.1/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.7.1
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.1
      dockerfile: dockerfiles/2.7.1/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.7.2

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.2
      dockerfile: dockerfiles/2.7.2/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.7.2
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.2
      dockerfile: dockerfiles/2.7.2/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.7.3

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.3
      dockerfile: dockerfiles/2.7.3/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.7.3
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.3
      dockerfile: dockerfiles/2.7.3/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.7.4

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.4
      dockerfile: dockerfiles/2.7.4/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.7.4
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.4
      dockerfile: dockerfiles/2.7.4/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.7.5

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.5
      dockerfile: dockerfiles/2.7.5/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.7.5
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.5
      dockerfile: dockerfiles/2.7.5/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.7.6

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.6
      dockerfile: dockerfiles/2.7.6/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.7.6
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.6
      dockerfile: dockerfiles/2.7.6/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.7.7

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.7
      dockerfile: dockerfiles/2.7.7/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.7.7
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.7
      dockerfile: dockerfiles/2.7.7/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.7.8

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.8
      dockerfile: dockerfiles/2.7.8/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.7.8
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.8
      dockerfile: dockerfiles/2.7.8/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.7.9

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.9
      dockerfile: dockerfiles/2.7.9/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.7.9
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.9
      dockerfile: dockerfiles/2.7.9/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.7.10

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.10
      dockerfile: dockerfiles/2.7.10/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.7.10
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.7.10
      dockerfile: dockerfiles/2.7.10/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.8.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.8.0
      dockerfile: dockerfiles/2.8.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.8.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.8.0
      dockerfile: dockerfiles/2.8.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.9.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.9.0
      dockerfile: dockerfiles/2.9.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.9.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.9.0
      dockerfile: dockerfiles/2.9.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.10.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.10.0
      dockerfile: dockerfiles/2.10.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.10.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.10.0
      dockerfile: dockerfiles/2.10.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.11.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.11.0
      dockerfile: dockerfiles/2.11.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.11.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.11.0
      dockerfile: dockerfiles/2.11.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.12.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.12.0
      dockerfile: dockerfiles/2.12.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.12.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.12.0
      dockerfile: dockerfiles/2.12.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.13.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.13.0
      dockerfile: dockerfiles/2.13.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.13.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.13.0
      dockerfile: dockerfiles/2.13.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.13.1

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.13.1
      dockerfile: dockerfiles/2.13.1/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.13.1
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.13.1
      dockerfile: dockerfiles/2.13.1/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.14.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.14.0
      dockerfile: dockerfiles/2.14.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.14.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.14.0
      dockerfile: dockerfiles/2.14.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.14.1

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.14.1
      dockerfile: dockerfiles/2.14.1/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.14.1
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.14.1
      dockerfile: dockerfiles/2.14.1/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.15.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.15.0
      dockerfile: dockerfiles/2.15.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.15.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.15.0
      dockerfile: dockerfiles/2.15.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.15.1

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.15.1
      dockerfile: dockerfiles/2.15.1/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.15.1
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.15.1
      dockerfile: dockerfiles/2.15.1/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.16.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.16.0
      dockerfile: dockerfiles/2.16.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.16.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.16.0
      dockerfile: dockerfiles/2.16.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.16.1

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.16.1
      dockerfile: dockerfiles/2.16.1/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.16.1
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.16.1
      dockerfile: dockerfiles/2.16.1/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

---
kind: pipeline
name: 2.17.0

steps:
    # Build the implementation and set the appropriate tag
  - name: build
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.17.0
      dockerfile: dockerfiles/2.17.0/Dockerfile
      dry_run: true  # Do not push at the end of this step
      purge: false

    # Store the resulting image on the host docker, so it can be used in the
    # next step.
    volumes:
      - name: docker
        path: /var/run/docker.sock

    # Start the implementation, the system under test, in the background
  - name: sut
    image: tlsprint/mbedtls:2.17.0
    detach: true

  - name: verify TLS10
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS10
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS11
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS11
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: verify TLS12
    image: tlsprint/tlsattackerconnector
    commands:
      - sleep 5
      - connector
        --targetHost sut
        --protocolVersion TLS12
        --cipherSuite "TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA"
        --test | tee result.log
      - "grep 'ApplicationData: APPLICATION|ConnectionClosed' result.log || grep 'ApplicationData: APPLICATION|ALERT_WARNING_CLOSE_NOTIFY|ConnectionClosed' result.log"

  - name: publish
    image: plugins/docker
    settings:
      repo: tlsprint/mbedtls
      tags: 2.17.0
      dockerfile: dockerfiles/2.17.0/Dockerfile
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
      purge: false

volumes:
    # Expose host docker to build steps
  - name: docker
    host:
      path: /var/run/docker.sock

